# 現状仕様（Current Spec）

本ドキュメントは 2025-10-19 時点の MOKU MVP の実装状態を「実際の挙動に基づいて」記述したもの。  
想定仕様・今後の理想・改善案は記載しない（別ドキュメントで管理）。

---

## 1. アプリ概要（現状）
- ログイン不要のオンライン自習室
- URL共有によりアプリホーム画面へ。ルーム一覧から誰でも即入室可能
- LiveKit Cloud を用いたビデオ通話
- ルーム単位でのポモドーロタイマー同期

---

## 2. ユースケースの現状挙動

### 2.1 ルーム一覧表示
- Firestoreからリアルタイム取得（リロード不要）
- 一覧には「部屋タイトル」「参加者名」「参加人数」が表示される

### 2.2 ルーム作成
- 「ニックネーム」「部屋タイトル」を入力すると作成される
- 作成と同時にルーム内へ遷移する
- 作成者がホストとして扱われる（実装としてそう動いている）

### 2.3 入室・退出
- ゲストは入室するとユーザー名と映像が左側に表示される
- ゲストには「ルーム一覧に戻る」ボタンがあり、それを押すと退出する
- ホストには「ルームを終了する」ボタンがあり、それを押すと部屋自体が削除される
- ホスト退出時にホスト権限は引き継がれない（そのまま終了する仕様になっている）
- 無人ルームでも自動終了はされない（残り続ける）
- ホストが「終了せずに退出」する手段は現在存在しない

### 2.4 共有ポモドーロタイマー
- 操作権限はホストのみ
- タイマーの進行は全参加者へ同期される
- 25分集中／5分休憩の2モードがある
- 「開始」「リセット」「作業／休憩切替」操作が可能

### 2.5 ビデオ通話（LiveKit）
- 初回入室時にブラウザがカメラ／マイク許可を求める
- 2回目以降はブラウザの許可設定に従って自動オンになる場合がある
- 複数人参加状態で画面をリロードすると音声が聞こえなくなることがある（再現頻度不定）
- 稀にホスト権限が喪失し全員ゲスト扱いになることがある
- 入室時に名前が表示されないケースが稀に発生する

### 2.6 チャット
- ルーム内チャット機能は現在存在しない

### 2.7 エンタメ機能
- 障害物避けゲーム：現在のUI上では非表示。コードは残存
- ランダム話題提供ボードは現時点では存在しない

---

## 3. 非機能仕様（現状）

### 3.1 コスト／運用関連
- 無人ルームの自動終了は存在しない
- ホスト無操作による終了処理は存在しない

### 3.2 技術スタック
- Frontend: React 19 + Vite
- Backend/DB: Firebase（Firestore + Hosting）
- Security: Firestore Security Rules（2025-10-21設定）
- Video: LiveKit Cloud
- Styling: Tailwind CSS

---

## 4. 現時点で認識している制約・現状の欠落
- ホスト退出時の権限移譲は存在しない
- ルームの自動終了処理は存在しない
- ホストは「終了せずに退出」できない
- 事前のカメラ／マイク設定は存在しない
- チャット機能は存在しない
- ランダム話題提供機能は存在しない
- 背景ぼかし機能は存在しない

---

（以上）
